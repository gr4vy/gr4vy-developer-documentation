---
title: Authentication
slug: /authentication
---

Gr4vy uses **Bearer (Token) Authentication ** to authenticate any API request.
The tokens used in these requests are **JSON Web Tokens (JWT)** that can be
created server side. All API requests must be made over HTTPS and any API calls
made to HTTP will not be accepted.

In this guide we will show you how to:

- [Use Bearer (Token) Authentication](#authenticate-an-api-call) to authenticate
  a single API call.
- [Create the cryptographic key-pair](#create-an-api-key-pair) used to sign a
  JWT.
- With a key-pair in hand you can then either
  - [Use an SDK to create a JWT](#jwts-using-sdks) which is by far the easier
    option.
  - [Or manually create JWT](#manual-jwts) in case you can't to use our SDKs.

:::note Learn more about JWT

Visit [`jwt.io`](https://jwti.io) to learn more about JWT and the tools
available in your programming language to create and validate them.

:::

## Authenticating an API call

Every Gr4vy APIs that requires authentication expect `authorization` HTTP-header
with a signed JWT token as it's value (prefixed with `bearer`).

```bash {2}
curl -i -X GET "https://api.{gid}.gr4vy.app/transactions" \
    -H "authorization: bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
```

## Create an API key-pair

To sign a JWT you will need to register a new cryptographic key-pair with your
Gr4vy instance. A key-pair consist of the public and a private keys that will be
used to sign (and subsequently verify) the JWT.

To create a new API key-pair visit the **Integrations** panel in your admin
console and generate and download a new API key-pair. You can store the key-pair
with your code or store it in a secure environment accessible to your
application.

## Generate JWTs with SDKs

## JWTs using SDK

## Manual JWTs

A JWT needs to be created server-side by your application to make an API call. A
JWT consist of a header, claims, and signature.

### JWT header

The header includes some basic details about this token and the encryption
algorithm used to create the signature. We currently only support `ES256` for
the JWT signature.

```json title="Header"
{
  "typ": "JWT",
  "alg": "ES256"
}
```

### JWT claims

The claims define what API key-pair was used to generate the token, some
timestamps to restrict its usage, and any potential scopes used to limit the use
of the token.

```json title="Claims"
{
  "iss": "gg9ILy",
  "nbf": 1607976645,
  "exp": 1607976314,
  "jti": "0fe1fb1b-2f7e-4c8d-b0eb-aae5d0ec98f7",
  "scope": ["embed"],
  "data": {
    "POST /transactions": {
      "amount": "200",
      "currency": "USD"
    },
    "GET /buyers/:buyer_id/payment-methods": {
      "buyer_id": "d757c76a-cbd7-4b56-95a3-40125b51b29c"
    }
  }
}
```

### JWT signature

The signature is generated by appending the Base64-encoded header and claims
(separated with a `.`) and run it through the `ES256` algorithm.

```
ECDSASHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  public_key,
  private_key
)
```

### Assembled JWT

The assembled JWT

### Supported JWT claims

|         | Description                                                                                                     | Required |
| ------- | :-------------------------------------------------------------------------------------------------------------- | :------- |
| `iss`   | The unique ID of the key-pair used to sign this token                                                           | Yes      |
| `nbf`   | The unix timestamp that this token was created at                                                               | Yes      |
| `exp`   | The unix timestamp that this token expires at                                                                   | Yes      |
| `jti`   | A random unique ID used for entropy                                                                             | Yes      |
| `scope` | A list of endpoints that this token is restricted to                                                            | No       |
| `data`  | A dictionary of key-value pairs used to pin query and request parameters to specific values for certain scopes. | No       |

### Supported scopes

| Scope               | Description                                                                                                                                               |
| :------------------ | :-------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `{resources}.read`  | Allows read-access to a type or resource. For example, `buyers.read` enabled read-access for buyers data.                                                 |
| `{resources}.write` | Allows write-access to a type or resource. For example, `buyers.write` enabled write-access for buyers data. This does not also allow read access.        |
| `sessions.write`    | Used by the refresh token, allowing it to be used to refresh the access token.                                                                            |
| `embed`             | A scope that represents all the access needed by Gr4vy Embed.                                                                                             |
| `auth`              | A scope that represents all the access needed by Gr4vy the admin interface. This scope should only work for session-tokens generated by Gr4vy for a user. |
